# =============================================================================
# Analytical-Intelligence v1 - Environment Variables Template
# =============================================================================
# Copy this file to .env and customize for your environment.
# Different variables are needed on Analysis vs Sensor servers.
# =============================================================================

# ┌───────────────────────────────────────────────────────────────────────────┐
# │                     ANALYSIS SERVER (.env)                                │
# └───────────────────────────────────────────────────────────────────────────┘
# Only these variables are needed on the Analysis server:

# API key for authenticating sensor agents (MUST match sensor's INGEST_API_KEY)
INGEST_API_KEY=ONuMcisin3paJYkPDaf0tt9n2deEBeaN

# PostgreSQL credentials (optional - defaults shown)
# POSTGRES_USER=ai
# POSTGRES_PASSWORD=ai2025
# POSTGRES_DB=ai_db

# ─────────────────────────────────────────────────────────────────────────────
# Network RF Model Settings (optional - defaults shown)
# ─────────────────────────────────────────────────────────────────────────────

# Only these attack labels will create detections (comma-separated)
# NETWORK_LABEL_ALLOWLIST=DoS,DDoS,Port Scanning,Brute Force

# What to do with non-allowed labels: "ignore" or "map_to_normal"
# NETWORK_NON_ALLOW_ACTION=ignore

# Confidence threshold for network detections
# NETWORK_ML_THRESHOLD=0.60

# ─────────────────────────────────────────────────────────────────────────────
# SSH Detection Settings (optional - defaults shown)
# ─────────────────────────────────────────────────────────────────────────────

# Number of failed attempts to trigger brute force alert
# SSH_BRUTEFORCE_THRESHOLD=5

# Time window for counting attempts (seconds)
# SSH_BRUTEFORCE_WINDOW_SECONDS=300


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                      SENSOR SERVER (.env)                                 │
# └───────────────────────────────────────────────────────────────────────────┘
# These variables are REQUIRED on the Sensor server:

# Analysis server address (IP or hostname - NO http://, NO port)
ANALYZER_HOST=<ANALYZER_IP>

# API key (MUST match Analysis server's INGEST_API_KEY)
INGEST_API_KEY=ONuMcisin3paJYkPDaf0tt9n2deEBeaN

# ⚠️ IMPORTANT: DEVICE_ID MUST BE UNIQUE FOR EACH SENSOR!
# This ID appears in the Devices UI at /devices
DEVICE_ID=sensor-01

# Human-readable hostname for this sensor
HOSTNAME=sensor-server

# ─────────────────────────────────────────────────────────────────────────────
# OPTIONAL Sensor Variables (usually don't need to change):
# ─────────────────────────────────────────────────────────────────────────────

# Network interface for packet capture (run `ip link show` to find yours)
# Common values: ens33, eth0, enp0s3
NET_IFACE=ens33

# Analysis server port (default: 8000)
# ANALYZER_PORT=8000

# Device IP override (leave empty for auto-detection from NET_IFACE)
# Only set this if auto-detection fails
# DEVICE_IP=


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                         QUICK SETUP GUIDE                                 │
# └───────────────────────────────────────────────────────────────────────────┘
#
# STEP 1: On Analysis Server
# --------------------------
# Create .env with only:
#   INGEST_API_KEY=MySecureKey12345
#
# STEP 2: On Each Sensor Server  
# -----------------------------
# Create .env with (EACH SENSOR NEEDS UNIQUE DEVICE_ID!):
#   ANALYZER_HOST=<analysis-server-ip>
#   INGEST_API_KEY=MySecureKey12345   # Same as Analysis!
#   DEVICE_ID=sensor-01               # UNIQUE per sensor!
#   HOSTNAME=datacenter-sensor
#   NET_IFACE=ens33                   # Your interface
#
# The sensor will auto-detect its own IP from NET_IFACE.
#
# STEP 3: View devices at:
#   http://<ANALYZER_IP>:8000/devices
#
# =============================================================================


# ┌───────────────────────────────────────────────────────────────────────────┐
# │                       TELEGRAM ALERTS (Optional)                          │
# └───────────────────────────────────────────────────────────────────────────┘
# Send Telegram alerts when high-severity detections occur.
# Bot: Analytical-Intelligence-Bot (@AI_Thread_Bot)
# Group: Analytical Intelligence | SOC Team
#
# Setup:
#   1. Create bot via @BotFather (or use existing)
#   2. Add bot to your Telegram group
#   3. Get chat_id (negative for groups)
#   4. Set TELEGRAM_BOT_TOKEN below
#   5. Set TELEGRAM_ENABLED=true
#   6. Restart: docker compose -f docker-compose.analysis.yml up -d --build
#
# ─────────────────────────────────────────────────────────────────────────────

# Enable/disable Telegram alerts (default: disabled)
TELEGRAM_ENABLED=true

# Bot token from @BotFather (REQUIRED if enabled)
# ⚠️ NEVER commit real tokens to Git! Rotate if leaked.
TELEGRAM_BOT_TOKEN=8294883366:AAH0aDwbmlsAlEgUhZdJ4U6zdhxei9cjL3I

# Target chat ID (negative for groups)
# Default: Analytical Intelligence | SOC Team group
TELEGRAM_CHAT_ID=-5228638760

# Minimum severity to trigger alerts: INFO, LOW, MEDIUM, HIGH, CRITICAL
TELEGRAM_MIN_SEVERITY=HIGH

# Rate limiting: max messages per minute
TELEGRAM_RATE_LIMIT_PER_MIN=20

# Deduplication: skip duplicate alerts within this window (seconds)
TELEGRAM_DEDUP_WINDOW_SECONDS=60

# API timeout (seconds)
TELEGRAM_TIMEOUT_SECONDS=10

# Send a test message on startup (set true once to verify, then false)
TELEGRAM_STARTUP_TEST=false

# Optional: public dashboard URL for links in alerts
# Example: https://siem.example.com:8000
PUBLIC_DASHBOARD_BASE_URL=https://192.168.61.157:8000

