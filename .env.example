# ====================================
# Mini-SIEM v1 - Environment Variables
# ====================================

# ----- Analysis Server Configuration -----
# PostgreSQL Database URL
DATABASE_URL=postgresql+asyncpg://siem:siempass123@postgres:5432/minisiem

# API Key for ingestion endpoints (same key used on sensor side)
INGEST_API_KEY=your-secure-api-key-change-me

# Backend Server Settings
BACKEND_HOST=0.0.0.0
BACKEND_PORT=8000

# Model Paths (relative to container /app)
SSH_MODEL_PATH=/app/models/ssh/ssh_lstm.joblib
NETWORK_MODEL_PATH=/app/models/network/model.joblib
NETWORK_FEATURES_PATH=/app/models/network/feature_list.json
NETWORK_LABELS_PATH=/app/models/network/label_map.json
NETWORK_PREPROCESS_PATH=/app/models/network/preprocess_config.json

# ----- Sensor Server Configuration -----
# Analysis Server URL (where backend runs)
ANALYZER_URL=http://192.168.1.20:8000

# API Key for sending events (must match INGEST_API_KEY on analysis server)
X_API_KEY=your-secure-api-key-change-me

# Device identification
DEVICE_ID=sensor-01
HOSTNAME=sensor-server
DEVICE_IP=192.168.1.10

# Network interface for packet capture (change if different)
NET_IFACE=ens33

# Flow collector timeouts (seconds)
FLOW_IDLE_TIMEOUT=2
FLOW_ACTIVE_TIMEOUT=5

# ----- PostgreSQL Settings (Analysis Server) -----
POSTGRES_USER=siem
POSTGRES_PASSWORD=siempass123
POSTGRES_DB=minisiem
