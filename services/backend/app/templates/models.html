{% extends "base.html" %}

{% block content %}
<div class="page-content">
    <div class="page-header">
        <h1>üß† ML Models</h1>
        <p class="subtitle">Status and configuration of detection models</p>
    </div>

    <div class="models-grid">
        <!-- SSH LSTM Model -->
        <div class="model-card {% if models.ssh_lstm.loaded %}loaded{% else %}not-loaded{% endif %}">
            <div class="model-header">
                <div class="model-icon">üîê</div>
                <div class="model-title">
                    <h2>SSH LSTM</h2>
                    <span class="model-status {% if models.ssh_lstm.loaded %}online{% else %}offline{% endif %}">
                        {{ 'LOADED' if models.ssh_lstm.loaded else 'NOT LOADED' }}
                    </span>
                </div>
            </div>
            <div class="model-body">
                <p class="model-description">
                    LSTM-based anomaly detection for SSH authentication patterns.
                    Analyzes auth.log events to detect brute force attacks and suspicious behavior.
                </p>
                <div class="model-stats">
                    <div class="model-stat">
                        <span class="stat-label">Tokens</span>
                        <span class="stat-value">{{ models.ssh_lstm.tokens }}</span>
                    </div>
                    <div class="model-stat">
                        <span class="stat-label">Window Size</span>
                        <span class="stat-value">{{ models.ssh_lstm.window_size }}</span>
                    </div>
                    <div class="model-stat">
                        <span class="stat-label">Threshold</span>
                        <span class="stat-value">{{ models.ssh_lstm.threshold }}</span>
                    </div>
                    <div class="model-stat">
                        <span class="stat-label">Fail Threshold</span>
                        <span class="stat-value">{{ models.ssh_lstm.fail_threshold }}</span>
                    </div>
                    <div class="model-stat">
                        <span class="stat-label">Time Window</span>
                        <span class="stat-value">{{ models.ssh_lstm.time_window_sec }}s</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Network ML Model -->
        <div class="model-card {% if models.network_ml.loaded %}loaded{% else %}not-loaded{% endif %}">
            <div class="model-header">
                <div class="model-icon">üåê</div>
                <div class="model-title">
                    <h2>Network ML</h2>
                    <span class="model-status {% if models.network_ml.loaded %}online{% else %}offline{% endif %}">
                        {{ 'LOADED' if models.network_ml.loaded else 'NOT LOADED' }}
                    </span>
                </div>
            </div>
            <div class="model-body">
                <p class="model-description">
                    Random Forest classifier trained on CIC-IDS2017 dataset.
                    Classifies network flows into attack categories using 70 flow features.
                </p>
                <div class="model-stats">
                    <div class="model-stat">
                        <span class="stat-label">Features</span>
                        <span class="stat-value">{{ models.network_ml.features_count }}</span>
                    </div>
                    <div class="model-stat">
                        <span class="stat-label">Classes</span>
                        <span class="stat-value">{{ models.network_ml.labels_count }}</span>
                    </div>
                </div>
                {% if models.network_ml.labels %}
                <div class="model-labels">
                    <h4>Attack Classes</h4>
                    <div class="label-tags">
                        {% for label in models.network_ml.labels %}
                        <span class="label-tag {% if label == 'BENIGN' %}benign{% else %}attack{% endif %}">{{ label
                            }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>

        <!-- Suricata Info Card -->
        <div class="model-card loaded">
            <div class="model-header">
                <div class="model-icon">ü¶à</div>
                <div class="model-title">
                    <h2>Suricata IDS</h2>
                    <span class="model-status online">ACTIVE</span>
                </div>
            </div>
            <div class="model-body">
                <p class="model-description">
                    Real-time signature-based network intrusion detection.
                    Uses Emerging Threats ruleset updated automatically via suricata-update.
                </p>
                <div class="model-stats">
                    <div class="model-stat">
                        <span class="stat-label">Detection</span>
                        <span class="stat-value">Real-time</span>
                    </div>
                    <div class="model-stat">
                        <span class="stat-label">Latency</span>
                        <span class="stat-value">~1 second</span>
                    </div>
                    <div class="model-stat">
                        <span class="stat-label">Mode</span>
                        <span class="stat-value">AF_PACKET</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}